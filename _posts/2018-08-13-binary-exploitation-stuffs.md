---
layout: post
current: post
cover: assets/images/bin.png
navigation: True
title: System Exploitation Stuff
date: 2018-08-13 12:00:00
tags: binary-exploitation
class: post-template
subclass: 'post'
author: shivam-shrirao
---

### Hi, I am Shivam

Yep I am Shivam and thats who I am. I am a system exploitation master with genuine skills in Binary Exploitation and some other stuff.

Below are some links here to pro articles which I have posted:

- [Return to PLT, GOT to bypass ASLR remotely](https://www.ret2rop.com/2018/08/return-to-plt-got-to-bypass-aslr-remote.html)
- [ Format String Exploits: Defeating Stack Canary, NX and ASLR Remotely on 64 bit](https://www.ret2rop.com/2018/08/format-string-defeating-stack-canary-nx-aslr-remote.html)
- [ Make Stack Executable again ](https://www.ret2rop.com/2018/08/make-stack-executable-again.html)
- [ Can we bruteforce ASLR ? ](https://www.ret2rop.com/2018/08/can-we-bruteforce-aslr.html)

A sample dump:

```
gdb-peda$ checksec
CANARY    : disabled
FORTIFY   : disabled
NX        : ENABLED
PIE       : disabled
RELRO     : Partial
gdb-peda$ r aa 45fac180e9eee72f4fd2d9386ea7033e52b7c740afc3d98a8d02301671
Starting program: /home/archer/test/backup aa 45fac180e9eee72f4fd



             ____________________________________________________
            /                                                    \
           |    _____________________________________________     |
           |   |                                             |    |
           |   |                                             |    |
           |   |                                             |    |
           |   |                                             |    |
           |   |                                             |    |
           |   |                                             |    |
           |   |             Secure Backup v1.0              |    |
           |   |                                             |    |
           |   |                                             |    |
           |   |                                             |    |
           |   |                                             |    |
           |   |                                             |    |
           |   |                                             |    |
           |   |_____________________________________________|    |
           |                                                      |
            \_____________________________________________________/
                   \_______________________________________/
                _______________________________________________
             _-'    .-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.  --- `-_
          _-'.-.-. .---.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.--.  .-.-.`-_
       _-'.-.-.-. .---.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-`__`. .-.-.-.`-_
    _-'.-.-.-.-. .-----.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-.-----. .-.-.-.-.`-_
 _-'.-.-.-.-.-. .---.-. .-----------------------------. .-.---. .---.-.-.-.`-_
:-----------------------------------------------------------------------------:
`---._.-----------------------------------------------------------------._.---'


 [+] Validated access token
 [+] Starting archiving Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac

Program received signal SIGSEGV, Segmentation fault.
[----------------------------------registers-----------------------------------]
EAX: 0x22b 
EBX: 0xffffced0 --> 0x4 
ECX: 0x0 
EDX: 0xf7f95854 --> 0x0 
ESI: 0xf7f93e28 --> 0x1ced30 
EDI: 0xffffce1f --> 0x796500 ('')
EBP: 0x72413971 ('q9Ar')
ESP: 0xffffbdf0 ("Ar2A")
EIP: 0x31724130 ('0Ar1')
EFLAGS: 0x10282 (carry parity adjust zero SIGN trap INTERRUPT direction overflow)
[-------------------------------------code-------------------------------------]
Invalid $PC address: 0x31724130
[------------------------------------stack-------------------------------------]
0000| 0xffffbdf0 ("Ar2A")
0004| 0xffffbdf4 --> 0x8049e00 ("V6paNLWrcLwokdPJeCIrUbn+C9TesqoaaXASnicAAAAAA==")
0008| 0xffffbdf8 --> 0x804d570 --> 0xfbad2498 
0012| 0xffffbdfc --> 0x8048a1b (<main+30>: sub    esp,0xc)
0016| 0xffffbe00 --> 0x0 
0020| 0xffffbe04 --> 0x0 
0024| 0xffffbe08 --> 0x0 
0028| 0xffffbe0c --> 0x0 
[------------------------------------------------------------------------------]
Legend: code, data, rodata, value
Stopped reason: SIGSEGV
0x31724130 in ?? ()
$ /opt/metasploit/tools/exploit/pattern_offset.rb -q 31724130
[*] Exact match at offset 512
```

Here is another dump:
```
$ readelf -a /usr/lib32/libc.so.6 | grep system
   251: 001265e0   102 FUNC    GLOBAL DEFAULT   13 svcerr_systemerr@@GLIBC_2.0
   640: 0003c7d0    55 FUNC    GLOBAL DEFAULT   13 __libc_system@@GLIBC_PRIVATE
  1485: 0003c7d0    55 FUNC    WEAK   DEFAULT   13 system@@GLIBC_2.0
   565: 00000000     0 FILE    LOCAL  DEFAULT  ABS system.c
   566: 0003c2b0  1086 FUNC    LOCAL  DEFAULT   13 do_system
  4988: 001265e0   102 FUNC    LOCAL  DEFAULT   13 __GI_svcerr_systemerr
  6919: 0003c7d0    55 FUNC    WEAK   DEFAULT   13 system
  7539: 001265e0   102 FUNC    GLOBAL DEFAULT   13 svcerr_systemerr
  7602: 0003c7d0    55 FUNC    GLOBAL DEFAULT   13 __libc_system
$ readelf -a /usr/lib32/libc.so.6 | grep exit  
  [26] __libc_atexit     PROGBITS        001cd268 1cc268 000004 00  WA  0   0  4
   03     .tdata .init_array __libc_subfreeres __libc_atexit __libc_thread_subfreeres __libc_IO_vtables .data.rel.ro .dynamic .got .data .bss 
   09     .tdata .init_array __libc_subfreeres __libc_atexit __libc_thread_subfreeres __libc_IO_vtables .data.rel.ro .dynamic .got 
001ceeb0  00058d06 R_386_GLOB_DAT    001cf1e4   argp_err_exit_status@@GLIBC_2.1
001cef9c  00086606 R_386_GLOB_DAT    001cf120   obstack_exit_failure@@GLIBC_2.0
   116: 0002ff20    39 FUNC    GLOBAL DEFAULT   13 __cxa_at_quick_exit@@GLIBC_2.10
   144: 0002fb10    33 FUNC    GLOBAL DEFAULT   13 exit@@GLIBC_2.0
   459: 0002ff50   181 FUNC    GLOBAL DEFAULT   13 __cxa_thread_atexit_impl@@GLIBC_2.18
   570: 000be685    24 FUNC    GLOBAL DEFAULT   13 _exit@@GLIBC_2.0
   629: 00129b30    56 FUNC    GLOBAL DEFAULT   13 svc_exit@@GLIBC_2.0
   [skipped]
$ strings -t x /usr/lib32/libc.so.6 | grep /bin/sh
 17888a /bin/sh
 ```
 These stuffs look dope as fuck ;)

Finally filled up much space :).

###### Disclaimer: 
This was all done as a part of testing whether all parts of the CMS has been built successfully. Please do take this stuff as ordinary `majak`. :)